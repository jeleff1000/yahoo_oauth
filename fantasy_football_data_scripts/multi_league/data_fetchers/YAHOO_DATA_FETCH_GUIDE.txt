"""
YAHOO FANTASY DATA FETCHER - USAGE GUIDE
=========================================

The yahoo_fantasy_data.py script has been created at:
C:\Users\joeye\OneDrive\Desktop\fantasy_football_data_downloads\fantasy_football_data_scripts\multi_league\data_fetchers\yahoo_fantasy_data.py

IMPORTANT: Your secrets.json needs to be updated with Yahoo OAuth credentials!

Current secrets.json is missing:
- consumer_key
- consumer_secret

STEP 1: UPDATE YOUR OAUTH FILE
-------------------------------

Your secrets.json should look like this:

{
    "consumer_key": "YOUR_CONSUMER_KEY",
    "consumer_secret": "YOUR_CONSUMER_SECRET",
    "access_token": "T5VD_lCf5FklMEFKFG2vJwlw...",
    "refresh_token": "AOKPul.doHFzu4o5k25Vw_cZhOIkjyJtaKz41GgZD4znGhpVMjI-",
    "token_time": 1762028177.3439827,
    "token_type": "bearer"
}

You can get consumer_key and consumer_secret from:
https://developer.yahoo.com/apps/


STEP 2: USAGE OPTIONS
---------------------

Option A: Direct usage (without league context)
------------------------------------------------

python run_yahoo_data_fetch.py --league-id nfl.l.123456 --oauth-file secrets.json --year 2024

Replace "nfl.l.123456" with your actual Yahoo league ID.


Option B: Using league context (recommended)
---------------------------------------------

First create a league_context.json file:

{
    "league_id": "nfl.l.123456",
    "league_name": "KMFFL",
    "oauth_file_path": "C:\\Users\\joeye\\OneDrive\\Desktop\\KMFFLApp\\secrets.json",
    "start_year": 2014,
    "end_year": 2024,
    "data_directory": "C:\\Users\\joeye\\OneDrive\\Desktop\\fantasy_football_data_downloads\\data"
}

Then run:

python run_yahoo_data_fetch.py --context league_context.json --year 2024

Or fetch all years:

python run_yahoo_data_fetch.py --context league_context.json --all-years


STEP 3: FIND YOUR LEAGUE ID
----------------------------

Your Yahoo league ID format: nfl.l.XXXXXX

To find it:
1. Go to your Yahoo Fantasy Football league page
2. Look at the URL - it will contain the league ID
   Example: https://football.fantasysports.yahoo.com/f1/123456
   League ID would be: nfl.l.123456

Or check any existing scripts/data files you have for the league ID.


STEP 4: RUN FROM KMFFLAPP DIRECTORY
------------------------------------

From PowerShell in C:\Users\joeye\OneDrive\Desktop\KMFFLApp:

# Single year
python run_yahoo_data_fetch.py --league-id nfl.l.YOUR_LEAGUE_ID --oauth-file secrets.json --year 2024

# Specific weeks
python run_yahoo_data_fetch.py --league-id nfl.l.YOUR_LEAGUE_ID --oauth-file secrets.json --year 2024 --weeks 1 2 3

# Specific positions only
python run_yahoo_data_fetch.py --league-id nfl.l.YOUR_LEAGUE_ID --oauth-file secrets.json --year 2024 --positions QB RB WR


OUTPUT
------

Files will be saved as:
{output_dir}/yahoo_player_stats_{year}.parquet

Default output directory: current directory
Or specify with: --output-dir path/to/output


TROUBLESHOOTING
---------------

1. If you get "OAuth file not found":
   - Make sure secrets.json has consumer_key and consumer_secret
   - Check the file path is correct

2. If you get "LeagueContext not available":
   - You can still use the script without league context
   - Use the --league-id and --oauth-file flags instead

3. If you get API rate limit errors:
   - Reduce the rate limit: --rate-limit 2.0
   - The script has automatic retry logic

4. To see debug output:
   - The script logs all actions with timestamps
   - Check for errors in the console output
"""
